{"version":3,"file":"commonHelpers.js","sources":["../src/js/server.js","../src/img/bi_x-octagon.svg","../src/js/message.js","../src/main.js"],"sourcesContent":["import axios, { Axios } from 'axios';\n\nconst instance = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n   headers: {\n     \"Content-Type\": \"application/json\",\n  },\n  params: {\n    key: '41582613-5fd86df2fe5af6dc3c1a0bcd8',\n    type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n   },\n});\n\nconst getAxiosData = (res) => res.data;\n\nexport const getImages = async (params) => {\n  try {\n    const resp = await instance.get('', { params: params });\n    return getAxiosData(resp);\n  }\n  catch (error) {\n    console.log(error.message);\n    // return;\n  }\n\n  \n}\n","export default \"__VITE_ASSET__3108d0c6__\"","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport iconUrl from '../img/bi_x-octagon.svg';\n\nexport const showError = (text) => {\n    iziToast.error({\n      message:text,\n      position: 'topRight',\n      backgroundColor: 'red',\n      messageColor:'white',\n      iconUrl: `${iconUrl}`,\n      iconColor: 'white',\n    })\n}\n\nexport const showMessage = (text) => {\n    iziToast.error({\n      message:text,\n      position: 'topRight',\n      backgroundColor: 'green',\n      messageColor:'white',\n      iconColor: 'white',\n    })\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getImages } from './js/server';\nimport { showError, showMessage } from './js/message';\n\nconst searchBtn = document.querySelector('.search-button');\nconst form = document.querySelector('.search-form');\nconst input = document.querySelector('.search-input');\nconst loader = document.querySelector('.loader-div');\nconst loadBtn = document.querySelector('.load-button');\n\nlet page = 1;\nlet doFetch = null;\nlet hits = [];\nlet query = '';\n\nconst handleSearch = async () => {\n  if (doFetch !== null) {\n    loadBtn.removeEventListener('click', doFetch); // видалення попередньої пагінації при новому пошуку\n    doFetch = null;\n  }\n\n  hideLoadBtn();\n  clearGallery();\n\n  query = getSearch();\n  if (!query) {\n    showMessage('Input your request!');\n    return;\n  };\n\n  const imagesRequest = createImagesRequest(query); //екземпляр функції через замикання\n\n  doFetch = async () => { // завантаження наступгої сторінки: стягує зображення через imagesRequest, відмальовує і прогортує\n    try {\n      hits = await makePromiseWithLoader(imagesRequest);\n      fillGallery(hits);\n      scrollPage();\n    }\n    catch (error) {\n      console.log(error.message);\n    }\n  }\n\n  try {\n    await makePromiseWithLoader(doFetch); // відображає перші стягнуті зображення \n  }\n  catch (error) {\n    console.log(error.message);\n  }\n\n  loadBtn.addEventListener('click', doFetch); //додає doFetch до Load more\n  \n  clearSearch();\n  \n}\n\nconst scrollPage = () => {\n  const card = document.querySelector('.card');\n  const vals = card.getBoundingClientRect();\n  if (page - 1 > 1) window.scrollBy({ top: vals.height * 2, behavior: 'smooth' });\n\n}\n\nconst getSearch = () => {\n  return input.value.trim().split(' ').join('+');\n}\n\nform.addEventListener('submit', (event) => {\n  event.preventDefault();\n  handleSearch();\n})\n\n\n\nconst fillGallery = (itemsList) => {\n  const galleryList = document.querySelector('.gallery-list');\n  let content = '';\n\n  content = itemsList.reduce((content, item) => {\n    return content +\n      `<li class=\"card\">\n            <a href=\"${item.largeImageURL}\">\n          <img\n            src=\"${item.webformatURL}\"\n            alt=\"${item.tags}\"\n            class=\"image\"\n          />\n          </a>\n          <div class=\"description\">\n            <div class=\"desc-part\">\n              <span class=\"bold\">Likes</span><span>${item.likes}</span>\n            </div>\n            <div class=\"desc-part\">\n              <span class=\"bold\">Views</span><span>${item.views}</span>\n            </div>\n            <div class=\"desc-part\">\n              <span class=\"bold\">Comments</span><span>${item.comments}</span>\n            </div>\n            <div class=\"desc-part\">\n              <span class=\"bold\">Downloads</span><span>${item.downloads}</span>\n            </div>\n          </div>\n        </li>\n        `\n  }, '');\n\n  galleryList.insertAdjacentHTML('beforeend',content);\n  gallery.refresh();\n}\n\nconst createImagesRequest = (q) => {\n  page = 1;\n  const per_page = 40;\n  let isLastPage = false;\n\n  return async () => {\n    try {\n      if (isLastPage) return [];\n      const { hits, total } = await getImages({ q, page, per_page });\n\n      if (total === 0) {\n        hideLoadBtn();\n        showError('Sorry, there are no images matching your search query. Please try again!');\n      }\n      else if (page >= Math.ceil(total / per_page)) {\n        isLastPage = true;\n        hideLoadBtn();\n        showMessage('We\\'re sorry, but you\\'ve reached the end of search results.');\n      }\n      else {\n        showLoadBtn();\n      }\n\n      page += 1;\n      \n      return hits ;\n\n    }\n    catch (error) {\n      showError('Error! No connection with server!');\n    }\n  }\n\n}\n\n\n\nconst makePromiseWithLoader = async(promise) => {\n  showLoader();\n  try {\n    const resp = await promise();\n    return resp;\n  }\n  catch (error) {\n    console.log(error.message);\n  }\n  finally {\n    hideLoader();\n  }\n}\n\nconst showLoadBtn = () => {\n  loadBtn.style.display = 'flex';\n}\nconst hideLoadBtn = () => {\n  loadBtn.style.display = 'none';\n}\n\nconst clearGallery = () => {\n  const galleryList = document.querySelector('.gallery-list');\n  galleryList.innerHTML = '';\n}\n\nconst clearSearch = () => {\n  input.value = '';\n}\n\nconst hideLoader = () => {\n  loader.style.display = 'none';\n}\n\nconst showLoader = () => {\n   loader.style.display = 'flex';\n}\n\nlet gallery = new SimpleLightbox('.gallery a', {\n  overlayOpacity: 0.1,\n  captionsData:'alt',\n});\n"],"names":["instance","axios","getAxiosData","res","getImages","params","resp","error","iconUrl","showError","text","iziToast","showMessage","form","input","loader","loadBtn","page","doFetch","hits","query","handleSearch","hideLoadBtn","clearGallery","getSearch","imagesRequest","createImagesRequest","makePromiseWithLoader","fillGallery","scrollPage","clearSearch","vals","event","itemsList","galleryList","content","item","gallery","q","per_page","isLastPage","total","showLoadBtn","promise","showLoader","hideLoader","SimpleLightbox"],"mappings":"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"}